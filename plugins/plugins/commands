#!/usr/bin/env bash
set -eo pipefail; [[ $DOKKU_TRACE ]] && set -x
case "$1" in
  plugins-install)
    pluginhook install
    ;;

  help)
    cat && cat<<EOF
    plugins         Print active plugins
    plugins-install Install active plugins
EOF
    ;;

esac

if [ -x $PLUGIN_PATH/$1/command ]; then
  exec "$PLUGIN_PATH/$1/command $@"
elif [ -x $PLUGIN_PATH/${1%%:*}/subcommands/${1#*:} ]; then
  exec "$PLUGIN_PATH/${1%%:*}/subcommands/${1#*:} $@"
fi
